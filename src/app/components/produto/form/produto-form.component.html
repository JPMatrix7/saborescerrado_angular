<mat-card>
  <mat-card-header>
    <mat-card-title>{{ isEditMode ? 'Editar Produto' : 'Novo Produto' }}</mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="produtoForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Nome</mat-label>
          <input matInput formControlName="nome" required>
          <mat-error *ngIf="produtoForm.get('nome')?.hasError('required')">
            Nome é obrigatório
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Tipo de Licor</mat-label>
          <mat-select formControlName="tipo" required>
            <mat-option *ngFor="let tipo of tiposLicor" [value]="tipo">
              {{ tipo }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Categoria</mat-label>
          <mat-select formControlName="categoriaId" required>
            <mat-option *ngFor="let categoria of categorias()" [value]="categoria.id">
              {{ categoria.nome }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Fornecedor</mat-label>
          <mat-select formControlName="fornecedorId" required>
            <mat-option *ngFor="let fornecedor of fornecedores()" [value]="fornecedor.id">
              {{ fornecedor.nomeFantasia || fornecedor.razaoSocial }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Descrição</mat-label>
        <textarea matInput formControlName="descricao" rows="3"></textarea>
      </mat-form-field>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Preço (R$)</mat-label>
          <input matInput type="number" formControlName="preco" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Estoque</mat-label>
          <input matInput type="number" formControlName="estoque" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Teor Alcoólico (%)</mat-label>
          <input matInput type="number" formControlName="teorAlcoolico" required>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Sabor</mat-label>
          <mat-select formControlName="saborId">
            <mat-option [value]="null">Nenhum</mat-option>
            <mat-option *ngFor="let sabor of sabores()" [value]="sabor.id">
              {{ sabor.nome }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Embalagem</mat-label>
          <mat-select formControlName="embalagemId">
            <mat-option [value]="null">Nenhuma</mat-option>
            <mat-option *ngFor="let embalagem of embalagens()" [value]="embalagem.id">
              {{ embalagem.volume }}ml - {{ embalagem.material }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Safra</mat-label>
          <mat-select formControlName="safraId">
            <mat-option [value]="null">Nenhuma</mat-option>
            <mat-option *ngFor="let safra of safras()" [value]="safra.id">
              {{ safra.anoSafra }} - {{ safra.fazenda }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>URL da Imagem</mat-label>
        <input matInput formControlName="imagemUrl">
      </mat-form-field>

      <div class="form-actions">
        <button mat-raised-button type="button" (click)="onCancel()">Cancelar</button>
        <button mat-raised-button color="primary" type="submit" [disabled]="!produtoForm.valid">
          Salvar
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
